<!doctype html>

<html lang="en">

<!--
  Apply head only for dev environment, this is required for jekyll to
  insert livereload scripts
-->

  <head>



  <meta charset="utf-8">


<title>Talking About PPPoE - Dalvik's Blog</title>

<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<!-- Define a description for better SEO result -->
<meta name="description" content="Definition The Point-to-Point Protocol over Ethernet (PPPoE) is a network protocol for encapsulating PPP frames inside Ethernet frames. PPP is running in Network Access Layer, which can be used through either Wi-Fi or an Ethernet cable. PPPoE Stages PPPoE has...">

<!-- Cheome Web App theme color -->
<meta name="theme-color" content="#ff00b4">

<!-- Feed URL -->
<link rel="alternate" href="/feed.xml" type="application/atom+xml">

<!-- Site icons -->
<link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" href="/favicon.png" type="image/png"><link rel="icon" href="/favicon.svg?assets-inline-assets-keep" sizes="any" type="image/svg+xml"><link rel="mask-icon" href="/mask-icon.svg" color="#ff00b4">

<!-- Chrome Web App manifest -->
<link rel="manifest" href="/manifest.json">

<!-- Main CSS -->
<link rel="stylesheet" href="/assets/themes/curtana/css/app.css?assets-inline">

<!-- Canonical links, avoid duplicate content problems -->
<link rel="canonical" href="http://0.0.0.0:4321/note/talking-about-pppoe/">

<!-- DNS prefetching for static files -->


<!-- Head hooks -->



  </head>

<!-- Open Graph and Twitter Cards support -->
<meta property="og:type" content="article">
<meta property="og:site_name" content="Dalvik's Blog">
<meta property="og:title" content="Talking About PPPoE">
<meta property="og:url" content="http://0.0.0.0:4321/note/talking-about-pppoe/">
<meta property="og:description" content="Definition The Point-to-Point Protocol over Ethernet (PPPoE) is a network protocol for encapsulating PPP frames inside Ethernet frames. PPP is running in Network Access Layer, which can be used through either Wi-Fi or an Ethernet cable. PPPoE Stages PPPoE has...">
<meta property="og:image" content="http://0.0.0.0:4321/logo.png">

<meta name="twitter:card" content="summary_large_image">


  <meta name="twitter:site" content="@tearfulDalvik">



  <meta name="twitter:creator" content="@tearfulDalvik">



  <meta property="article:published_time" content="2018-08-27T00:00:00+08:00">
  <meta property="article:modified_time" content="2019-05-23T21:00:16+08:00">
  <meta name="twitter:label1" value="Words">
  <meta name="twitter:data1" value="361 words">
  <meta name="twitter:label2" value="Reading time">
  <meta name="twitter:data2" value="1 min">

<!-- Post specified styles -->
<style data-assets-inline>
  :root {
    

    

    

    
  }

  body {
    
  }

  
  
    
</style>
<!-- Main navigation with current page / categoriy highlighted -->
<nav class="navigation">
  <ul>
    <li >
        <a href="/">Dalvik's Blog</a>
      </li>
    <li >
        <a href="/work/">Work</a>
      </li>
    <li class=current>
        <a href="/note/">Note</a>
      </li>
    <li >
        <a href="/about/">About</a>
      </li>
    
  </ul>
</nav>
<!-- Main content wrap -->
<main class="content " role=main>
  <!-- Post-wide custom CSS -->


<!-- Article wrapper, limit width -->
<article lang="en">

  <!-- Post title -->
  <header style="     ">

    <h1 class="" title="Talking About PPPoE" data-title="Talking About PPPoE">
      Talking About PPPoE<span class="dot dot--post"> </span>
    </h1>

    
      <small>
        By <span rel="author">Dalvik Shen</span>
        on <time datetime="2018-08-27T00:00:00+08:00">Aug 27, 2018</time>
      </small>
    

    

  </header>

  <!-- Post content -->
  <div class="post-content">
    <h2 id="definition">Definition</h2>
<p>The Point-to-Point Protocol over Ethernet (PPPoE) is a network protocol for encapsulating PPP frames inside Ethernet frames.</p>

<p><strong>PPP is running in Network Access Layer, which can be used through either Wi-Fi or an Ethernet cable.</strong></p>

<h2 id="pppoe-stages">PPPoE Stages</h2>
<details>
  <summary>PPPoE has two stages (Click to expand)</summary>
  <ul>
    <li>When a client wants to establish a PPPoE connection, it must send a broadcast packet to discover PPPoE servers, then select one. This process is called the PPPoE Discovery (PAD).</li>
    <li>When a server was chosen, PPP session starts, LCP packets appear. The client and server start to negotiate, authentic, etc. Once these are done, the client will get an IP address and the radius server allows gateways to route for this client.</li>
  </ul>
</details>

<h2 id="pad-tags">PAD Tags</h2>
<p>Tags show up in  <abbr title="PPPoE discovery">PAD</abbr> stage, they play a very important role.<br />
This is a PAD Tag:</p>

<pre><code class="language-Hex">0000   01 01 00 00 01 03 00 08 00 bd a6 7c 80 ff ff ff
0010   01 02 00 1b 43 51 2d 4e 41 2d 4e 50 2d 42 41 53
0020   2d 31 2e 4d 41 4e 2e 4d 45 36 30 2d 58 31 36
</code></pre>
<p>Tags are shown as payload in PAD stage. <code class="highlighter-rouge">0x0101</code> is the Service-Name<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> (See the first two bytes in line 0000), next two bytes <code class="highlighter-rouge">0x0000</code> tell its length is 0.<br />
Then <code class="highlighter-rouge">0x01030008</code> means Host-Uniq, which has 8 bytes. Therefore the next 8 bytes are the value of this attribute.</p>

<p>Note that the Host-Uniq, generated by the client, must be the same in the whole PAD process.</p>

<h2 id="magic-number">Magic Number</h2>
<p>The magic number in PPPoE protocol is used to check whether a loop appears.<br />
The first time magic number appears is in the Configuration Request. Each Ack packet must have the same magic number from Request packet which you are acknowledging.<br />
<del><sub>Or you’ll get a <code class="highlighter-rouge">Nak</code> packet later.</sub></del></p>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://en.wikipedia.org/wiki/Point-to-Point_Protocol_over_Ethernet">Point-to-Point Protocol over Ethernet - Wikipedia</a></li>
  <li><a href="https://datatracker.ietf.org/doc/rfc2516/?include_text=1">A Method for Transmitting PPP Over Ethernet (PPPoE)</a></li>
</ul>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>See <a href="https://tools.ietf.org/html/rfc2516#appendix-A">Appendix A</a> in RFC 2516 <a href="#fnref:1" class="reversefootnote">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>


    
    

    
  </div>

</article>

</main>
<!-- Footer section -->

  <footer class="footer">
    <ul>
      <li><a href="/">Dalvik's Blog</a></li>

      
        <li>
          <a href="https://sparanoid.com/lab/amsf/" title="Almace Scaffolding with theme Curtana">AMSF</a>
        </li>
      

      
    </ul>
  </footer>


<!-- Theme scripts -->
<script src="/assets/themes/curtana/js/app.js?assets-inline"></script>

<!-- User scripts -->
<script src="/assets/js/user.js?assets-inline"></script>

<!-- Lightense Images -->


<!-- Service Worker  -->


<!-- Google Analytics -->
<script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-131388356-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js"></script>

<!-- Foot hooks -->


<!-- Finale -->
</html>
